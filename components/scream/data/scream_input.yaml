%YAML 1.1
---
Atmosphere Driver:

  Atmosphere Processes:
    Number of Entries: 6
    Schedule Type: Sequential
    Process 0:
      Process Name: Homme
      Enable Output Fields Checks: false
      Enable Input Fields Checks: false
      Grid: Dynamics
      Vertical Coordinate Filename: "<${COMPSET} : .*SCREAM%AQUA.* => ${DIN_LOC_ROOT}/atm/scream/init/scream-aquaplanet_init_ne4np4_L72_20211202.nc : ${DIN_LOC_ROOT}/atm/scream/init/init_ne4np4.nc>"
      Moisture: moist
    Process 1:
      Process Name: SHOC
      Enable Output Fields Checks: false
      Enable Input Fields Checks: false
      Grid: Physics GLL
    Process 2:
      Process Name: CldFraction
      Enable Output Fields Checks: false
      Enable Input Fields Checks: false
      Grid: Physics GLL
    Process 3:
      Process Name: SPA
      Enable Output Fields Checks: false
      Enable Input Fields Checks: false
      Grid: Physics GLL
      SPA Remap File: none
      SPA Data File: ${DIN_LOC_ROOT}/atm/scream/init/spa_file_unified_and_complete_ne4_scream.nc
      # TODO: Fix the SPA remap file and data file to be dependent on the grid resolution.  For now we hardcode the ne4 case.
    Process 4:
      Process Name: P3
      Enable Output Fields Checks: false
      Enable Input Fields Checks: false
      Grid: Physics GLL
    Process 5:
      Process Name: RRTMGP
      Enable Output Fields Checks: false
      Enable Input Fields Checks: false
      Grid: Physics GLL
      active_gases:
      - h2o
      - co2
      - o3
      - n2o
      - co
      - ch4
      - o2
      - n2
      # Year to use for orbital calculations. If positive, use a fixed year for
      # orbital computations, in the same way EAM F-compsets are configured. If
      # negative, compute using current model year. This setting will be IGNORED
      # if orbital parameters below are set to non-negative values in favor of
      # using fixed orbital parameters (e.g., for aquaplanet compsets)
      Orbital Year: -9999 # Negative means compute from current year
      # Orbital parameters; if positive, use orbital parameters specified
      # and ignore orbital year setting.
      Orbital Eccentricity: "<${COMPSET} : .*SCREAM%AQUA.* => 0 : -9999>"  # Eccentricity for orbital computations
      Orbital Obliquity:    "<${COMPSET} : .*SCREAM%AQUA.* => 0 : -9999>"  # Obliquity for orbital computations
      Orbital MVELP:        "<${COMPSET} : .*SCREAM%AQUA.* => 0 : -9999>"  # Vernal Equinox Mean Longitude of Perihelion

  Time Stepping:
    Time Step: 300
    Start Time: [12, 30, 00]    # Hours, Minutes, Seconds
    Start Date: [2000, 2, 1]    # Year, Month, Day
    Number of Steps: 288

  Grids Manager:
    Type: Dynamics Driven
    Reference Grid: Physics GLL
    Dynamics Driven:
      Dynamics Namelist File Name: ./data/namelist.nl

  Initial Conditions:
    Physics GLL:
      Filename: "<${COMPSET} : .*SCREAM%AQUA.* => ${DIN_LOC_ROOT}/atm/scream/init/scream-aquaplanet_init_ne4np4_L72_20211202.nc : ${DIN_LOC_ROOT}/atm/scream/init/init_ne4np4.nc>"
      # Set X_prev = X
      T_mid_prev: T_mid
      horiz_winds_prev: horiz_winds
      w_int: 0.0 # Start from zero vert velocity
      w_int_prev: 0.0
    Dynamics:
      tracers: tracers, Physics GLL

  # The parameters for I/O control
  Scorpio:
    Output YAML Files: ["data/scream_output.yaml"]

SCREAM:

  Start Date: "${RUN_STARTDATE}"

  # These files must be symlinked to $rundir/data since there is no
  # mechanism to configure the path to these.
  Input Files:
    - "${DIN_LOC_ROOT}/atm/scream/init/rrtmgp-data-sw-g224-2018-12-04.nc"
    - "${DIN_LOC_ROOT}/atm/scream/init/rrtmgp-data-lw-g256-2018-12-04.nc"
    - "${DIN_LOC_ROOT}/atm/scream/init/rrtmgp-cloud-optics-coeffs-sw.nc"
    - "${DIN_LOC_ROOT}/atm/scream/init/rrtmgp-cloud-optics-coeffs-lw.nc"
    - "${DIN_LOC_ROOT}/atm/scream/tables/p3_lookup_table_1.dat-v4.1.1"

# Note: HOMME settings will be translated into data/namelist.nl
HOMME:
  ctl_nl:
    disable_diagnostics             : .false.
    se_partmethod                   : 4
    se_topology                     : "cube"
    se_ftype                        : 0
    se_limiter_option               : 9
    se_ne                           : 4
    se_geometry                     : "sphere"
    se_tstep                        : 300
    mesh_file                       : '/dev/null'
    rotate_grid                     : 0
    u_perturb                       : 1
    statefreq                       : 9999
    tstep_type                      : 5
    dt_remap_factor                 : 1
    dt_tracer_factor                : 1
    nu                              : 3.4e-8
    nu_div                          : -1
    nu_p                            : -1
    nu_q                            : -1
    nu_s                            : -1
    nu_top                          : 2.5e+5
    vert_remap_q_alg                : 10
    hypervis_scaling                : 3.0
    hypervis_order                  : 2
    hypervis_subcycle               : 1
    hypervis_subcycle_tom           : 1
    hypervis_subcycle_q             : 1
    theta_hydrostatic_mode          : true
    theta_advect_form               : 1
    COORD_TRANSFORM_METHOD          : 0
    Z2_MAP_METHOD                   : 0
    vthreads                        : 1    ! number of vertical/column threads per horizontal thread
    npart                           : 0
    numnodes                        : 0
    se_ne_x                         : 0             ! element resolution factor in x-dir for planar
    se_ne_y                         : 0             ! element resolution factor in y-dir for planar
    integration                     : "explicit"    ! integration method
    transport_alg                   : 0      ! SE Eulerianclassical SLcell-integrated SL
    semi_lagrange_cdr_alg           : 0
    semi_lagrange_cdr_check         : .false.
    semi_lagrange_hv_q              : 0
    semi_lagrange_nearest_point_lev : 0
    cubed_sphere_map                : 0
    prescribed_wind                 : 0
    tom_sponge_start                : 0
    dcmip16_mu                      : 0
    dcmip16_mu_s                    : 0
    dcmip16_mu_q                    : 0
    dcmip16_prec_type               : 0
    dcmip16_pbl_type                : 0
    smooth_phis_numcycle            : 0
    smooth_phis_p2filt              : 0
    smooth_phis_nudt                : 0
    initial_total_mass              : 0
    vtheta_thresh                   : 0
    pgrad_correction                : 0
    hv_ref_profiles                 : 0
    hv_theta_correction             : 0
    hv_theta_thresh                 : 0
    vert_remap_u_alg                : -2

...
