













      module mo_lu_solve

      private
      public :: lu_slv

      contains
                                                                        
      subroutine lu_slv01( lu, b )
                                                                        

      use shr_kind_mod, only : r8 => shr_kind_r8
                                                                        
      implicit none
                                                                        
!-----------------------------------------------------------------------
!       ... Dummy args
!-----------------------------------------------------------------------
      real(r8), intent(in) ::   lu(:)
      real(r8), intent(inout) ::   b(:)
                                                                        
!-----------------------------------------------------------------------
!       ... Local variables
!-----------------------------------------------------------------------
                                                                        
!-----------------------------------------------------------------------
!       ... solve L * y = b
!-----------------------------------------------------------------------
         b(22) = b(22) - lu(2) * b(1)
         b(24) = b(24) - lu(3) * b(1)
                                                                        
         b(17) = b(17) - lu(5) * b(2)
         b(18) = b(18) - lu(6) * b(2)
                                                                        
         b(7) = b(7) - lu(8) * b(3)
         b(18) = b(18) - lu(9) * b(3)
         b(21) = b(21) - lu(10) * b(3)
                                                                        
         b(10) = b(10) - lu(12) * b(4)
         b(12) = b(12) - lu(13) * b(4)
         b(16) = b(16) - lu(14) * b(4)
         b(19) = b(19) - lu(15) * b(4)
         b(22) = b(22) - lu(16) * b(4)
                                                                        
         b(10) = b(10) - lu(18) * b(5)
         b(14) = b(14) - lu(19) * b(5)
         b(15) = b(15) - lu(20) * b(5)
         b(19) = b(19) - lu(21) * b(5)
         b(22) = b(22) - lu(22) * b(5)
                                                                        
         b(10) = b(10) - lu(24) * b(6)
         b(20) = b(20) - lu(25) * b(6)
         b(22) = b(22) - lu(26) * b(6)
         b(24) = b(24) - lu(27) * b(6)
                                                                        
         b(18) = b(18) - lu(29) * b(7)
         b(21) = b(21) - lu(30) * b(7)
         b(22) = b(22) - lu(31) * b(7)
                                                                        
         b(18) = b(18) - lu(33) * b(8)
         b(21) = b(21) - lu(34) * b(8)
         b(22) = b(22) - lu(35) * b(8)
         b(24) = b(24) - lu(36) * b(8)
                                                                        
         b(13) = b(13) - lu(38) * b(9)
         b(16) = b(16) - lu(39) * b(9)
         b(22) = b(22) - lu(40) * b(9)
         b(24) = b(24) - lu(41) * b(9)
                                                                        
         b(22) = b(22) - lu(43) * b(10)
         b(24) = b(24) - lu(44) * b(10)
                                                                        
         b(13) = b(13) - lu(48) * b(11)
         b(16) = b(16) - lu(49) * b(11)
         b(17) = b(17) - lu(50) * b(11)
         b(18) = b(18) - lu(51) * b(11)
         b(22) = b(22) - lu(52) * b(11)
         b(23) = b(23) - lu(53) * b(11)
         b(24) = b(24) - lu(54) * b(11)
                                                                        
         b(16) = b(16) - lu(57) * b(12)
         b(18) = b(18) - lu(58) * b(12)
         b(20) = b(20) - lu(59) * b(12)
         b(22) = b(22) - lu(60) * b(12)
         b(23) = b(23) - lu(61) * b(12)
         b(24) = b(24) - lu(62) * b(12)
                                                                        
         b(16) = b(16) - lu(66) * b(13)
         b(18) = b(18) - lu(67) * b(13)
         b(20) = b(20) - lu(68) * b(13)
         b(22) = b(22) - lu(69) * b(13)
         b(23) = b(23) - lu(70) * b(13)
         b(24) = b(24) - lu(71) * b(13)
                                                                        
         b(15) = b(15) - lu(76) * b(14)
         b(16) = b(16) - lu(77) * b(14)
         b(18) = b(18) - lu(78) * b(14)
         b(20) = b(20) - lu(79) * b(14)
         b(22) = b(22) - lu(80) * b(14)
         b(23) = b(23) - lu(81) * b(14)
         b(24) = b(24) - lu(82) * b(14)
                                                                        
         b(16) = b(16) - lu(87) * b(15)
         b(17) = b(17) - lu(88) * b(15)
         b(18) = b(18) - lu(89) * b(15)
         b(19) = b(19) - lu(90) * b(15)
         b(20) = b(20) - lu(91) * b(15)
         b(22) = b(22) - lu(92) * b(15)
         b(23) = b(23) - lu(93) * b(15)
         b(24) = b(24) - lu(94) * b(15)
                                                                        
         b(17) = b(17) - lu(97) * b(16)
         b(18) = b(18) - lu(98) * b(16)
         b(20) = b(20) - lu(99) * b(16)
         b(21) = b(21) - lu(100) * b(16)
         b(22) = b(22) - lu(101) * b(16)
         b(24) = b(24) - lu(102) * b(16)
                                                                        
         b(18) = b(18) - lu(106) * b(17)
         b(20) = b(20) - lu(107) * b(17)
         b(22) = b(22) - lu(108) * b(17)
         b(23) = b(23) - lu(109) * b(17)
         b(24) = b(24) - lu(110) * b(17)
                                                                        
         b(19) = b(19) - lu(117) * b(18)
         b(20) = b(20) - lu(118) * b(18)
         b(21) = b(21) - lu(119) * b(18)
         b(22) = b(22) - lu(120) * b(18)
         b(23) = b(23) - lu(121) * b(18)
         b(24) = b(24) - lu(122) * b(18)
                                                                        
         b(20) = b(20) - lu(133) * b(19)
         b(21) = b(21) - lu(134) * b(19)
         b(22) = b(22) - lu(135) * b(19)
         b(23) = b(23) - lu(136) * b(19)
         b(24) = b(24) - lu(137) * b(19)
                                                                        
         b(21) = b(21) - lu(149) * b(20)
         b(22) = b(22) - lu(150) * b(20)
         b(23) = b(23) - lu(151) * b(20)
         b(24) = b(24) - lu(152) * b(20)
                                                                        
         b(22) = b(22) - lu(161) * b(21)
         b(23) = b(23) - lu(162) * b(21)
         b(24) = b(24) - lu(163) * b(21)
                                                                        
         b(23) = b(23) - lu(184) * b(22)
         b(24) = b(24) - lu(185) * b(22)
                                                                        
         b(24) = b(24) - lu(200) * b(23)
                                                                        
                                                                        
      end subroutine lu_slv01
                                                                        
      subroutine lu_slv02( lu, b )
                                                                        

      use shr_kind_mod, only : r8 => shr_kind_r8
                                                                        
      implicit none
                                                                        
!-----------------------------------------------------------------------
!       ... Dummy args
!-----------------------------------------------------------------------
      real(r8), intent(in) ::   lu(:)
      real(r8), intent(inout) ::   b(:)
                                                                        
!-----------------------------------------------------------------------
!       ... Local variables
!-----------------------------------------------------------------------
                                                                        
!-----------------------------------------------------------------------
!       ... solve L * y = b
!-----------------------------------------------------------------------
                                                                        
!-----------------------------------------------------------------------
!       ... Solve U * x = y
!-----------------------------------------------------------------------
         b(24) = b(24) * lu(219)
         b(23) = b(23) - lu(218) * b(24)
         b(22) = b(22) - lu(217) * b(24)
         b(21) = b(21) - lu(216) * b(24)
         b(20) = b(20) - lu(215) * b(24)
         b(19) = b(19) - lu(214) * b(24)
         b(18) = b(18) - lu(213) * b(24)
         b(17) = b(17) - lu(212) * b(24)
         b(16) = b(16) - lu(211) * b(24)
         b(15) = b(15) - lu(210) * b(24)
         b(14) = b(14) - lu(209) * b(24)
         b(13) = b(13) - lu(208) * b(24)
         b(12) = b(12) - lu(207) * b(24)
         b(11) = b(11) - lu(206) * b(24)
         b(10) = b(10) - lu(205) * b(24)
         b(9) = b(9) - lu(204) * b(24)
         b(8) = b(8) - lu(203) * b(24)
         b(6) = b(6) - lu(202) * b(24)
         b(1) = b(1) - lu(201) * b(24)
                                                                        
         b(23) = b(23) * lu(199)
         b(22) = b(22) - lu(198) * b(23)
         b(21) = b(21) - lu(197) * b(23)
         b(20) = b(20) - lu(196) * b(23)
         b(19) = b(19) - lu(195) * b(23)
         b(18) = b(18) - lu(194) * b(23)
         b(17) = b(17) - lu(193) * b(23)
         b(16) = b(16) - lu(192) * b(23)
         b(15) = b(15) - lu(191) * b(23)
         b(14) = b(14) - lu(190) * b(23)
         b(13) = b(13) - lu(189) * b(23)
         b(12) = b(12) - lu(188) * b(23)
         b(11) = b(11) - lu(187) * b(23)
         b(10) = b(10) - lu(186) * b(23)
                                                                        
         b(22) = b(22) * lu(183)
         b(21) = b(21) - lu(182) * b(22)
         b(20) = b(20) - lu(181) * b(22)
         b(19) = b(19) - lu(180) * b(22)
         b(18) = b(18) - lu(179) * b(22)
         b(17) = b(17) - lu(178) * b(22)
         b(16) = b(16) - lu(177) * b(22)
         b(15) = b(15) - lu(176) * b(22)
         b(14) = b(14) - lu(175) * b(22)
         b(13) = b(13) - lu(174) * b(22)
         b(12) = b(12) - lu(173) * b(22)
         b(11) = b(11) - lu(172) * b(22)
         b(10) = b(10) - lu(171) * b(22)
         b(9) = b(9) - lu(170) * b(22)
         b(8) = b(8) - lu(169) * b(22)
         b(7) = b(7) - lu(168) * b(22)
         b(6) = b(6) - lu(167) * b(22)
         b(5) = b(5) - lu(166) * b(22)
         b(4) = b(4) - lu(165) * b(22)
         b(1) = b(1) - lu(164) * b(22)
                                                                        
         b(21) = b(21) * lu(160)
         b(20) = b(20) - lu(159) * b(21)
         b(19) = b(19) - lu(158) * b(21)
         b(18) = b(18) - lu(157) * b(21)
         b(17) = b(17) - lu(156) * b(21)
         b(16) = b(16) - lu(155) * b(21)
         b(7) = b(7) - lu(154) * b(21)
         b(3) = b(3) - lu(153) * b(21)
                                                                        
         b(20) = b(20) * lu(148)
         b(19) = b(19) - lu(147) * b(20)
         b(18) = b(18) - lu(146) * b(20)
         b(17) = b(17) - lu(145) * b(20)
         b(16) = b(16) - lu(144) * b(20)
         b(15) = b(15) - lu(143) * b(20)
         b(14) = b(14) - lu(142) * b(20)
         b(13) = b(13) - lu(141) * b(20)
         b(12) = b(12) - lu(140) * b(20)
         b(10) = b(10) - lu(139) * b(20)
         b(6) = b(6) - lu(138) * b(20)
                                                                        
         b(19) = b(19) * lu(132)
         b(18) = b(18) - lu(131) * b(19)
         b(17) = b(17) - lu(130) * b(19)
         b(16) = b(16) - lu(129) * b(19)
         b(15) = b(15) - lu(128) * b(19)
         b(14) = b(14) - lu(127) * b(19)
         b(12) = b(12) - lu(126) * b(19)
         b(10) = b(10) - lu(125) * b(19)
         b(5) = b(5) - lu(124) * b(19)
         b(4) = b(4) - lu(123) * b(19)
                                                                        
         b(18) = b(18) * lu(116)
         b(17) = b(17) - lu(115) * b(18)
         b(8) = b(8) - lu(114) * b(18)
         b(7) = b(7) - lu(113) * b(18)
         b(3) = b(3) - lu(112) * b(18)
         b(2) = b(2) - lu(111) * b(18)
                                                                        
         b(17) = b(17) * lu(105)
         b(10) = b(10) - lu(104) * b(17)
         b(2) = b(2) - lu(103) * b(17)
                                                                        
         b(16) = b(16) * lu(96)
         b(7) = b(7) - lu(95) * b(16)
                                                                        
         b(15) = b(15) * lu(86)
         b(13) = b(13) - lu(85) * b(15)
         b(11) = b(11) - lu(84) * b(15)
         b(10) = b(10) - lu(83) * b(15)
                                                                        
         b(14) = b(14) * lu(75)
         b(13) = b(13) - lu(74) * b(14)
         b(10) = b(10) - lu(73) * b(14)
         b(9) = b(9) - lu(72) * b(14)
                                                                        
         b(13) = b(13) * lu(65)
         b(10) = b(10) - lu(64) * b(13)
         b(9) = b(9) - lu(63) * b(13)
                                                                        
         b(12) = b(12) * lu(56)
         b(10) = b(10) - lu(55) * b(12)
                                                                        
         b(11) = b(11) * lu(47)
         b(10) = b(10) - lu(46) * b(11)
         b(9) = b(9) - lu(45) * b(11)
                                                                        
         b(10) = b(10) * lu(42)
                                                                        
         b(9) = b(9) * lu(37)
                                                                        
         b(8) = b(8) * lu(32)
                                                                        
         b(7) = b(7) * lu(28)
                                                                        
         b(6) = b(6) * lu(23)
                                                                        
         b(5) = b(5) * lu(17)
                                                                        
         b(4) = b(4) * lu(11)
                                                                        
         b(3) = b(3) * lu(7)
                                                                        
         b(2) = b(2) * lu(4)
                                                                        
         b(1) = b(1) * lu(1)
                                                                        
                                                                        
      end subroutine lu_slv02
                                                                        
      subroutine lu_slv( lu, b )
                                                                        

      use shr_kind_mod, only : r8 => shr_kind_r8
                                                                        
      implicit none
                                                                        
!-----------------------------------------------------------------------
!       ... Dummy args
!-----------------------------------------------------------------------
      real(r8), intent(in) ::   lu(:)
      real(r8), intent(inout) ::   b(:)
                                                                        
      call lu_slv01( lu, b )
      call lu_slv02( lu, b )
                                                                        
      end subroutine lu_slv
                                                                        
      end module mo_lu_solve
